### ========================================
### API Vendor Microservice - SoukScan
### Exemples de requêtes HTTP
### ========================================

@baseUrl = http://localhost:8081/api/vendors

### ========================================
### 1. CRÉATION DE VENDORS
### ========================================

### 1.1 Propriétaire crée son shop avec document (PENDING) - email + phone obligatoires
POST {{baseUrl}}
Content-Type: application/json

    {
      "userId": 101,
      "shopName": "Supermarché Atlas",
      "shopAddress": "Avenue Mohammed VI, Casablanca",
      "description": "Grand supermarché avec tous les produits alimentaires",
      "email": "contact@supermarche-atlas.ma",
      "phone": "+212 5 22 99 88 77",
      "city": "Casablanca",
      "country": "Maroc",
      "postalCode": "20000",
      "taxId": "TAX789456",
      "shopVerificationFilePath": "/documents/patente_supermarche.pdf",
      "latitude": 33.589886,
      "longitude": -7.603869
    }

### 1.2 Propriétaire crée son shop sans document (UNVERIFIED) - email + phone obligatoires
POST {{baseUrl}}
Content-Type: application/json

{
  "userId": 103,
  "shopName": "Café Central",
  "shopAddress": "Place Mohammed V, Rabat",
  "description": "Café traditionnel au centre ville",
  "email": "cafe.central@example.ma",
  "phone": "+212 5 37 55 66 77",
  "city": "Rabat",
  "country": "Maroc",
  "latitude": 34.020882,
  "longitude": -6.841650
}

### 1.3 Utilisateur déclare un shop découvert - email/phone optionnels
POST {{baseUrl}}
Content-Type: application/json

{
  "declaredByUserId": 50,
  "shopName": "Hanout Hay Mohammadi",
  "shopAddress": "Hay Mohammadi, Casablanca",
  "city": "Casablanca",
  "country": "Maroc",
  "latitude": 33.558729,
  "longitude": -7.647874
}

### 1.4 Utilisateur déclare un shop avec quelques infos connues
POST {{baseUrl}}
Content-Type: application/json

{
  "declaredByUserId": 52,
  "shopName": "Épicerie près de la gare",
  "shopAddress": "Près de la gare Casa Voyageurs",
  "phone": "+212 6 77 88 99 00",
  "city": "Casablanca",
  "country": "Maroc",
  "latitude": 33.589886,
  "longitude": -7.603869
}

### ========================================
### 2. CONSULTATION DE VENDORS
### ========================================

### 2.1 Récupérer tous les vendors
GET {{baseUrl}}

### 2.2 Récupérer un vendor par ID
GET {{baseUrl}}/1

### 2.3 Récupérer le vendor d'un utilisateur
GET {{baseUrl}}/user/101

### 2.4 Récupérer les vendors actifs
GET {{baseUrl}}/active

### 2.5 Récupérer les vendors vérifiés
GET {{baseUrl}}/verified

### 2.6 Récupérer les vendors en attente de vérification
GET {{baseUrl}}/pending

### 2.7 Récupérer les vendors par statut (PENDING)
GET {{baseUrl}}/status/PENDING

### 2.8 Récupérer les vendors par statut (VERIFIED)
GET {{baseUrl}}/status/VERIFIED

### 2.9 Récupérer les vendors par statut (UNVERIFIED)
GET {{baseUrl}}/status/UNVERIFIED

### 2.10 Récupérer les vendors par ville
GET {{baseUrl}}/city/Casablanca

### 2.11 Rechercher des vendors par nom
GET {{baseUrl}}/search?name=supermarché

### 2.12 Récupérer les shops déclarés par un utilisateur
GET {{baseUrl}}/declared-by/50

### ========================================
### 3. MISE À JOUR DE VENDORS
### ========================================

### 3.1 Mettre à jour un vendor
PUT {{baseUrl}}/1
Content-Type: application/json

{
  "userId": 1,
  "shopName": "Épicerie Bio Casablanca Premium",
  "shopAddress": "12 Rue des Orangers, Maarif, Casablanca",
  "description": "Épicerie spécialisée dans les produits biologiques locaux et importés. Fruits, légumes, produits laitiers, épicerie sèche et produits sans gluten.",
  "email": "contact@epiceriebio.ma",
  "phone": "+212 5 22 12 34 56",
  "city": "Casablanca",
  "country": "Maroc",
  "postalCode": "20250",
  "taxId": "TAX123456",
  "latitude": 33.573109,
  "longitude": -7.589843
}

### 3.2 Activer/Désactiver un vendor
PATCH {{baseUrl}}/1/toggle-status

### ========================================
### 4. GESTION ADMIN - VÉRIFICATION
### ========================================

### 4.1 Vérifier un vendor (approuver)
PATCH {{baseUrl}}/3/verify?adminId=1

### 4.2 Rejeter un vendor
PATCH {{baseUrl}}/4/reject?adminId=1

### ========================================
### 5. DÉCLARATION DE SHOP EXISTANT
### ========================================

### 5.1 Utilisateur déclare un shop existant (ajouter à la liste des déclarants)
POST {{baseUrl}}/1/declare?userId=60

### 5.2 Un autre utilisateur déclare le même shop
POST {{baseUrl}}/1/declare?userId=61

### 5.3 Un troisième utilisateur déclare le même shop
POST {{baseUrl}}/1/declare?userId=62

### ========================================
### 5bis. TEST ANTI-DOUBLONS (Auto-détection)
### ========================================

### 5bis.1 Premier utilisateur découvre un shop "Épicerie du Coin"
POST {{baseUrl}}
Content-Type: application/json

{
  "declaredByUserId": 100,
  "shopName": "Épicerie du Coin",
  "shopAddress": "Quartier Maarif, Casablanca",
  "city": "Casablanca",
  "country": "Maroc",
  "latitude": 33.573109,
  "longitude": -7.589843
}

### 5bis.2 Deuxième utilisateur déclare le MÊME shop (auto-détecté, pas de doublon créé)
POST {{baseUrl}}
Content-Type: application/json

{
  "declaredByUserId": 101,
  "shopName": "Épicerie du Coin",
  "shopAddress": "Quartier Maarif, Casablanca",
  "phone": "+212 6 11 22 33 44",
  "city": "Casablanca",
  "country": "Maroc",
  "latitude": 33.573109,
  "longitude": -7.589843
}

### 5bis.3 Troisième utilisateur déclare le MÊME shop avec plus d'infos
POST {{baseUrl}}
Content-Type: application/json

{
  "declaredByUserId": 102,
  "shopName": "Épicerie du Coin",
  "shopAddress": "Quartier Maarif, Casablanca",
  "description": "Petite épicerie de quartier ouverte tard",
  "email": "epicerie.coin@example.ma",
  "city": "Casablanca",
  "country": "Maroc",
  "latitude": 33.573200,
  "longitude": -7.589900
}

### 5bis.4 Vérifier qu'un seul shop existe avec 3 déclarants
GET {{baseUrl}}/search?name=Épicerie du Coin

### ========================================
### 6. SUPPRESSION
### ========================================

### 6.1 Supprimer un vendor
DELETE {{baseUrl}}/10

### ========================================
### 7. SCÉNARIOS DE TEST COMPLETS
### ========================================

### Scénario 1 : Vendeur crée son shop avec document
# 1. Créer le shop (statut PENDING)
POST {{baseUrl}}
Content-Type: application/json

{
  "userId": 201,
  "shopName": "Boulangerie Pâtisserie Moderne",
  "shopAddress": "56 Rue Allal Ben Abdellah, Rabat",
  "description": "Boulangerie artisanale, pâtisserie française et marocaine",
  "email": "contact@boulangerie-moderne.ma",
  "phone": "+212 5 37 77 88 99",
  "city": "Rabat",
  "country": "Maroc",
  "postalCode": "10000",
  "taxId": "TAX654321",
  "shopVerificationFilePath": "/documents/patente_boulangerie.pdf",
  "latitude": 34.020882,
  "longitude": -6.841650
}

# 2. Admin vérifie le shop (statut VERIFIED)
# PATCH {{baseUrl}}/{id}/verify?adminId=1

# 3. Consulter le shop vérifié
# GET {{baseUrl}}/{id}

### Scénario 2 : Utilisateur déclare un shop (comme Waze)
# 1. Créer le shop déclaré (statut UNVERIFIED)
POST {{baseUrl}}
Content-Type: application/json

{
  "userId": 202,
  "shopName": "Supérette Quartier Industriel",
  "shopAddress": "Zone Industrielle Aïn Sebaa, Casablanca",
  "email": "superette.industriel@example.ma",
  "phone": "+212 6 88 99 00 11",
  "city": "Casablanca",
  "country": "Maroc",
  "declaredByUserId": 75,
  "latitude": 33.614797,
  "longitude": -7.525881
}

# 2. Consulter le shop non vérifié
# GET {{baseUrl}}/{id}

# 3. Si le propriétaire ajoute un document, admin peut le vérifier
# PATCH {{baseUrl}}/{id}/verify?adminId=1

### Scénario 3 : Admin rejette un shop
# 1. Créer un shop
POST {{baseUrl}}
Content-Type: application/json

{
  "userId": 203,
  "shopName": "Shop Test Rejet",
  "shopAddress": "Adresse test",
  "email": "test.rejet@example.ma",
  "city": "Test",
  "country": "Test",
  "shopVerificationFilePath": "/documents/test.pdf"
}

# 2. Admin rejette le shop
# PATCH {{baseUrl}}/{id}/reject?adminId=1

# 3. Vérifier que le shop est désactivé
# GET {{baseUrl}}/{id}

### ========================================
### 7. FILTRES AVANCÉS (exemples)
### ========================================

### 7.1 Tous les shops vérifiés à Casablanca
# 1. GET {{baseUrl}}/verified
# 2. Filtrer par city="Casablanca" côté client
# Ou créer un endpoint : GET {{baseUrl}}/verified/city/Casablanca

### 7.2 Tous les shops avec rating > 4.5
# À implémenter côté service si besoin

### 7.3 Shops déclarés par un utilisateur spécifique
GET {{baseUrl}}/declared-by/50

### ========================================
### 8. STATISTIQUES (à implémenter)
### ========================================

### 8.1 Nombre de vendors par statut
# GET {{baseUrl}}/statistics/by-status

### 8.2 Nombre de vendors par ville
# GET {{baseUrl}}/statistics/by-city

### 8.3 Top vendors par rating
# GET {{baseUrl}}/top-rated?limit=10

### ========================================
### NOTES
### ========================================

# - Assurez-vous que le serveur tourne sur le port 8081
# - Remplacez {id} par l'ID réel du vendor
# - Les userId doivent correspondre aux utilisateurs du microservice Auth
# - adminId doit être l'ID d'un utilisateur avec le rôle ADMIN
# - Pour les tests, vous pouvez utiliser Postman, Insomnia ou l'extension REST Client de VS Code

